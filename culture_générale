---
title: "La culture général est le jardin de l’esprit ou chaque connaissance plantée fleurit en sagesse"
author: "Boughazi Meriem et Boudamous Lyna"
date: '2023-12-18'
output:
  html_document:
    toc: yes
    toc_float: yes
    highlight: kate
    theme: united
    df_print: paged
editor_options: 
  chunk_output_type: console
---


```{r Options pour les prochains chunks, echo = FALSE}
knitr::opts_chunk$set(
  message = FALSE, echo = FALSE, warning = FALSE
  )
```

```{r}
rsconnect::setAccountInfo(name='lyna37', token='000EEBAC6A293FEE7F9B88ADF28C042D', secret='DhyBYRCESdBUxsQWyE8hf2UDsJTyktxMx1Su37d6')
```

```{r Liste des package}
library(tidyverse)
library(plotly)
library(knitr)
library(kableExtra)
library(ggridges)
library(readr)
library(dplyr)
library(forcats)
library(modelsummary)
library(readr)
library(rcartocolor)
library(ggplot2)
library(plotly)
```

```{r Thème choisi pour ggplot2}
theme_set(theme_minimal()) 
```

```{r Base de données}
data <- read_delim("datasondage/sondage_20231109.csv",delim = ";")
```

```{r Renomme colonnes}
new_colnames <- c("age", "genre", "taille", "annee_etude", "filliere", "pays_naissance", "annee_bac",                            "specialite_term", "type_bac", "choix_licence", "travail_scolaire", "transport", "temps_transport", "tabac", "alcool", "soiree", "phobie", "jeux_videos", "os_telephone", "age_telephone", "os", "age_ordinateur", "support_note", "materiel","reseau_prefere", "temps_reseaux", "temps_telephone", "source_info", "cult1", "cult2","cult3", "cult4", "cult5", "cult6", "cult7", "cult8", "cult9", "cult10", "triche", "note")
colnames(data) <- new_colnames
```
# Introduction

Lors de leur parcours académique, les étudiants explorent la culture générale, une vaste étendue de connaissances transcendant les disciplines. Cette toile de fond intellectuelle enrichit leurs perspectives, nourrit leur curiosité et contribue à leur développement académique, formant ainsi des individus éclairés et dotés d'une vision élargie du monde.


## Présentation du sujet 

Pour notre projet de fin de semestre nous allons tenter d’analyser certaine caractéristique des étudiants de l’université de Tours concernant leur culture générale dans ce cadre en fait référence à une étude qui a été menée à l’automne 2023.Cette étude, basée sur un sondage réalisé par **Mme Scholler et nous**, les étudiants de L3 d'Économie à l’[université de Tours](https://www.univ-tours.fr/), dans le cadre de nos cours de logiciel **R3**. Notre étude se porte sur la culture générale des étudiants, par conséquent nous allons tenter de répondre aux question suivante :

* *Quelle est la perception (niveau de confiance) des répondants sur leur culture générale par genre?*

* *A quel question les répondants ont le mieux répondu ?le moins bien répondu?*

* *Y a-t-il une corrélation entre le temps de travail personnel et le niveau de culture générale ?*

* *Existe-t-il des différences significatives en termes de culture générale entre les filières d'études ?*

* *Quel est le niveau de culture générale des étudiants ?*

* *Comment la culture générale varie-t-elle en fonction du niveau d'études ?*
* *Existe-t-il des différences entre les genres en ce qui concerne la culture générale ?*



## Présentation des données 

Nous disposons de **`r ncol(data)`** question avec **`r nrow(data)`** de répondants,des étudiants de L1,L2 et L3 dont l’âge est compris entre **`r min(data$age)` ** et **`r max(data$age)`** ans, dans la base donnée réalisée par **Mme Scholler** contenant les réponses des étudiants de **l’université de Tours**.
Les questions abordent divers sujets dont la  culture générale, mais nous avons décidé de nous focaliser spécifiquement sur celles-ci. Voici un exemple de questions qui nous ont été posées :

+ *Quelle est la plus large chaîne de montagne du monde ?*

+ *Quel est le nom de la femme noire qui a refusé de céder sa place à un homme blanc dans un bus en 1955 aux États-Unis ?*

+ *Au cours de quel siècle, Cléopâtre, a-t-elle régné ?*

+ *Quel naturaliste a révolutionné la biologie avec son ouvrage “L'Origine des espèces” paru en 1859 ?*
+ *À quel mot correspond la définition suivante : répartition dans le temps d’une charge financière correspondant au remplacement d’un bien,
machine, appareil, etc.?*

+ *Qui est Niki de Saint Phalle ?* 

+ *Combien de temps dure la rotation complète de la Lune autour de la Terre ?*

+ *En quelle année est définitivement proclamée l’abolition de l’esclavage en France ?*

+ *Qui a inventé l'expression "la main invisible" ?*

+ *Quel écrivain et philosophe français a raconté l’histoire de Candide ?*

+ *Avez-bien joué le jeu et répondu sans consulté de source d'information ?*
+ *Vous pensez avoir combien de réponses juste sur les 10 questions ? (0 - 10)*


# Perception de la Culture Générale par Genre 

```{r}
library(ggplot2)
library(dplyr)


p <- ggplot(data, aes(x = genre, y = note, fill = genre)) +
  geom_bar(stat = "summary", fun = "mean", position = "dodge", color = NA) +
  geom_crossbar(stat = "summary", fun = "median", position = "dodge", width = 0.5, fill = "white", color = "#C70039") +
  stat_summary(fun.data = "mean_cl_normal", geom = "text", aes(label = round(..y.., 2)), position = position_dodge(width = 0.8), vjust = 12, color = "black") +
  labs(
    x = "Genre", y = "Moyenne de la Note"
  ) +
  scale_fill_manual(values = c("Masculin" = "#3182bd", "Féminin" = "pink"), name = "Genre") +
  scale_color_manual(values = c("Masculin" = "#3182bd", "Féminin" = "pink"), name = "Genre") +
  theme_minimal() +
  theme(
    legend.position = "right",
    legend.title = element_text(face = "italic", hjust = 0.5),
    legend.background = element_rect(fill = "palegoldenrod", color = NA),
    legend.text = element_text(face = "italic"),
    axis.text.x = element_text(face = "italic", hjust = 0.5),
    axis.text.y = element_text(face = "italic"),
    axis.title = element_text(face = "italic"),
    panel.border = element_blank(),
    plot.title = element_text(face = "bold", size = 15, hjust = 0.5)  
  )
ggplotly(p)
```

**Commentaire**

*Le diagramme illustre la moyenne et la médiane des évaluations de culture générale en fonction du genre (féminin et masculin). Une observation notable est que les hommes affichent généralement plus de confiance que les femmes. En moyenne, les hommes estiment obtenir une note de 6,26/10, tandis que les femmes estiment atteindre une moyenne de 5,47.*

*Le segment rouge représente la médiane, qui se situe à 6 pour les deux groupes (féminin et masculin). Ainsi, bien que les deux sexes aient une médiane égale, on peut constater que les femmes semblent avoir une moyenne légèrement inférieure à celle des hommes.*

**conclusion**
les hommes semblent avoir une perception de la culture générale plus élevée que les femmes.*


# Analyse des Réponses Exceptionnelles et Moins Performantes des Participants


```{r}
bonnes_reponses <- c(
  "la cordillère des Andes",
  "Rosa Parks",
  "1er siècle avant JC",
  "Charles Darwin",
  "amortissement",
  "une peintre",
  "28 jours",
  "1848",
  "Adam Smith",
  "Voltaire"
)

calcule_note <- function(row, bonnes_reponses) {
  note <- sum(row["cult1"] == bonnes_reponses[1],
               row["cult2"] == bonnes_reponses[2],
               row["cult3"] == bonnes_reponses[3],
               row["cult4"] == bonnes_reponses[4],
               row["cult5"] == bonnes_reponses[5],
               row["cult6"] == bonnes_reponses[6],
               row["cult7"] == bonnes_reponses[7],
               row["cult8"] == bonnes_reponses[8],
               row["cult9"] == bonnes_reponses[9],
               row["cult10"] == bonnes_reponses[10])
  return(note)
}

data$vrai_note <- apply(data, 1, calcule_note, bonnes_reponses = bonnes_reponses)
```

```{r}
questions_textuelles <- c(
  "Quelle est la plus large chaîne de montagne du monde ?",
  "Quel est le nom de la femme noire qui a refusé de céder sa place à un homme blanc dans un bus en 1955 aux États-Unis ?",
  "Au cours de quel siècle, Cléopâtre, a-t-elle régné ?",
  "Quel naturaliste a révolutionné la biologie avec son ouvrage “L'Origine des espèces” paru en 1859 ?",
  "À quel mot correspond la définition suivante : répartition dans le temps d’une charge financière correspondant au remplacement d’un bien, machine, appareil, etc. ?",
  "Qui est Niki de Saint Phalle ?",
  "Combien de temps dure la rotation complète de la Lune autour de la Terre ?",
  "En quelle année est définitivement proclamée l’abolition de l’esclavage en France ?",
  "Qui a inventé l'expression 'la main invisible' ?",
  "Quel écrivain et philosophe français a raconté l’histoire de Candide ?"
)

bonnes_reponses <- c("la cordillère des Andes", "Rosa Parks", "1er siècle avant JC", "Charles Darwin", "amortissement", "une peintre", "28 jours", "1848", "Adam Smith", "Voltaire")

resultats <- sapply(seq_along(bonnes_reponses), function(i) {
  mean(data[[paste0("cult", i)]] == bonnes_reponses[i], na.rm = TRUE) * 100
})


taux_bonnes_reponses <- data.frame(
  Questions = questions_textuelles,
  Pourcentage = resultats
)


taux_bonnes_reponses$Pourcentage <- sprintf("%.2f%%", taux_bonnes_reponses$Pourcentage)


meilleur_taux <- max(taux_bonnes_reponses$Pourcentage)
moins_bon_taux <- min(taux_bonnes_reponses$Pourcentage)


kable(taux_bonnes_reponses, "html", align = 'c', col.names = c("Questions", "Pourcentage de bonnes réponses")) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive")) %>%
  row_spec(which(taux_bonnes_reponses$Pourcentage == meilleur_taux), background = "lightgreen") %>%
  row_spec(which(taux_bonnes_reponses$Pourcentage == moins_bon_taux), background = "#C70039") %>%
  add_header_above(c("Taux de Bonnes Réponses par Question" = 2))



taux_bonnes_reponses$Pourcentage_num <- as.numeric(sub("%", "", taux_bonnes_reponses$Pourcentage))


taux_bonnes_reponses$Pourcentage_num <- as.numeric(sub("%", "", taux_bonnes_reponses$Pourcentage))



nombre_questions <- nrow(taux_bonnes_reponses)
taux_bonnes_reponses$Questions <- paste("Q", seq_len(nombre_questions), sep = "")
  
```

**Commentaire**

*L'analyse des performances des participants révèle que 93.27 % d'entre eux ont répondu correctement à la question 2. En revanche, seulement 36.06 % ont correctement répondu à la question 1, suggérant une difficulté accrue pour cette dernière.*

*La majorité des participants (78.85 %) ont réussi à répondre correctement à la question 5. Notons cependant que seuls 32.46 % ont correctement répondu à la question 4, soulignant sa complexité pour eux.*

*Il est également remarquable que 67.31 % des participants ont correctement répondu à la question 3. Bien que cette question soit relativement difficile, la plupart des participants ont pu y répondre correctement.*

*Concernant les points faibles des participants, la plupart ont échoué à répondre correctement à la question 1, portant sur la chaîne de montagne la plus longue du monde. Malgré des réponses intéressantes, seulement 32.46 % ont répondu correctement.*

*De plus, seuls 45.67 % des participants ont répondu correctement à la question 4, centrée sur la répartition financière dans le temps, indiquant sa difficulté pour les participants.*


## Analyse des Performances par Question : 

```{r}
# Create the plot and assign it to p
p <- ggplot(taux_bonnes_reponses, aes(x = fct_reorder(Questions, Pourcentage_num), y = Pourcentage_num, fill = Questions,text = paste(" Questions:", Questions, "<br> Pourcentage_num :",      Pourcentage_num))) +
  geom_bar(stat = "identity") + 
  theme_minimal() + 
  coord_flip() + 
  scale_fill_brewer(palette = "Greens", guide = "none") + # Use a discrete color palette
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  labs(
    x = "Questions",
    y = "Pourcentage de bonnes réponses"
  )

# Convert the plot to a Plotly interactive plot
ggplotly(p,tooltip = "text" )


```

**Commentaire**

*Les questions deux (93.27%), quatre (87.02%), et huit (78.85%) affichent les pourcentages de bonnes réponses les plus élevés par rapport aux autres questions.*


# Analyse leTemps de Travail Personnel et le Niveau de Culture Générale 


```{r}
data_clean <- data %>%
  filter(travail_scolaire > 0 & travail_scolaire <= 60)

g <- ggplot(data_clean, aes(x = travail_scolaire, y = vrai_note, color = vrai_note)) +
  geom_point() +
  labs(
    x = "Temps de travail personnel (heures/semaine)",
    y = "Niveau de culture générale (note sur 10)",
    color = "Niveau de culture\ngénérale (sur 10)"  
  ) +
  theme_minimal() +
  scale_color_gradient(low = "#C70039", high = "lightgreen") +
  theme(
    legend.position = "bottom",  
    legend.title.align = 0.5,   
    plot.caption = element_text(hjust = 0.5) 
  ) +
  annotate("text", x = Inf, y = Inf, label = "Chaque point représente un étudiant.\nLa couleur indique son niveau de culture générale.", hjust = 1.1, vjust = 1.1, size = 3)
ggplotly(g)
```

**commentaitre**

*Il semble que les données ne montrent pas de corrélation significative entre le temps de travail personnel et le niveau de culture générale chez les étudiants. Les points semblent être dispersés dans l'espace, ce qui indique qu'il n'y a pas de tendance ou de relation claire entre les deux variables.Il est également intéressant de remarquer que le temps de travail personnel n'est pas directement lié au niveau de la culture générale. Bien que la relation entre les deux variables soit moins évidente, cela pourrait être dû au fait que les bonnes réponses ne reflètent pas nécessairement le temps de travail personnel des participants.*

## Test Pearson 

```{r}
cor_test <- cor.test(data_clean$travail_scolaire, data_clean$vrai_note, method = "pearson")
cor_test 
```

**Commentaire:**

*Le coefficient de corrélation observé entre le temps de travail personnel et le niveau de culture générale est de 0.02842844, indiquant une corrélation très faible, voire inexistante sur le plan linéaire. La p-value associée à cette corrélation est de 0.6917, dépassant largement le seuil de significativité conventionnel de 0.05. De plus, l'intervalle de confiance à 95% pour le coefficient de corrélation varie de -0.1118116 à 0.1675582. Ces résultats suggèrent qu'il n'y a pas de relation significative entre le temps de travail personnel et le niveau de culture générale dans notre échantillon.*

**Conclusion :**

*Les résultats du test de corrélation de Pearson suggèrent qu'il n'y a pas de relation significative entre le temps de travail personnel et le niveau de culture générale dans cet échantillon de données.*



# Analyse des Différences de Niveau de Culture Générale


```{r}
ggplot(data, aes(x = filliere, y = vrai_note, fill = filliere)) +
  geom_boxplot() +
  scale_fill_manual(values = c("Autre" = "lightblue", "Gestion" = "lightgreen", "Économie" = "#C70039")) +
  labs(
    x = "Filière",
    y = "Niveau de culture générale (note sur 10)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 15),
    axis.title.x = element_text(face = "italic"),
    axis.title.y = element_text(face = "italic"),
    legend.position = "none"
  ) +
  annotate("text", x = Inf, y = Inf, label = "Les boîtes à moustaches montrent la distribution\ndes notes par filière, indiquant les médianes,\nles quartiles et les valeurs aberrantes.", hjust = 1.1, vjust = 1.1, size = 3) +
theme(legend.position = "bottom")
```

**Commentaire**

*ce graphe fournit un aperçu des niveaux de culture générale dans les différentes filières d'études et met en évidence les spécificités de chaque filière en matière de culture générale.Cette information est particulièrement utile pour les décideurs, car elle permet de mieux comprendre les spécificités de chaque filière et d'adapter les programmes et les ressources éducatives en conséquence.*

## Test de Kruskal-Wallis

```{r}
library(kableExtra)
library(knitr)
if (shapiro.test(data$vrai_note)$p.value > 0.05 && bartlett.test(vrai_note ~ filliere, data = data)$p.value > 0.05) {
  anova_result <- aov(vrai_note ~ filliere, data = data)
  print(summary(anova_result)) 
} else {
  kruskal_result <- kruskal.test(vrai_note ~ filliere, data = data)
  print(kruskal_result)
} 

```

**Commentaire :**


*La valeur du test du chi-carré de Kruskal-Wallis est de 1.3959, reflétant la mesure de la différence globale entre les groupes de filières. La p-value associée à ce test est de 0.4976, dépassant le seuil standard de significativité de 0.05. Ces résultats indiquent qu'il n'y a pas de preuve statistiquement significative pour affirmer que les variations observées dans les niveaux de culture générale entre les filières sont autre chose que le fruit du hasard.*

*En résumé, les conclusions du test de Kruskal-Wallis suggèrent qu'aucune différence significative n'est observée en termes de culture générale entre les étudiants des diverses filières d'études dans cet échantillon. Autrement dit, selon ces données, la filière d'études d'un étudiant ne semble pas être un indicateur significatif de son niveau de culture générale.*


# Évaluation du Niveau de Culture Générale des Étudiants 


```{r}
library(modelsummary)
```

```{r}
data$surestimation<-data$vrai_note-data$note 
quanti_var <- c(40,41,42) 
quali_var <- c(29:38) 
```

```{r}
datasummary_skim(data[, quanti_var]) 
datasummary_skim(data[,quali_var], 
                 type = "categorical")
```

**Commentaire**

*L'analyse des données recueillies dans notre enquête fournit des perspectives significatives sur le niveau de culture générale des étudiants interrogés. La moyenne des notes obtenues atteint 6.0, présentant une variabilité marquée illustrée par un écart-type de 2.0. En ce qui concerne des questions spécifiques, 61.1% des répondants ont correctement identifié l'Himalaya comme la plus vaste chaîne de montagnes, tandis que 69.7% ont bien assimilé la notion d'amortissement en finance. Des performances notables ont été enregistrées sur des questions emblématiques, telles que l'identification de Rosa Parks (93.3%), qui a refusé de céder sa place à un homme noir aux États-Unis en 1955, les 28 jours représentant la durée de rotation de la Lune (67.3%), et l'attribution de "la main invisible" à Adam Smith (72.1%).*

**Conclusion**

*Les questions portant sur la femme noire qui a refusé de céder sa place à un homme noir en 1955 aux États-Unis (cult2), sur le naturaliste qui a révolutionné la biologie avec son ouvrage "L'Origine des espèces" paru en 1859 (cult4) et sur la durée de rotation de la Lune (cult7) ont généré des taux élevés de réponses correctes. En revanche, les questions relatives à la plus vaste chaîne de montagnes (le massif de l'Atlas, Mae Jemison et les Rocheuses) ont obtenu des taux de réponses plus faibles. Les variations significatives dans les réponses soulignent la diversité des connaissances des étudiants en culture générale, offrant ainsi un aperçu détaillé de leurs performances sur chaque question spécifique.*

# Culture général selon le niveau d'étude

```{r}
p  <- ggplot(data, aes(x = vrai_note, fill = annee_etude)) +
  geom_density(alpha = 0.5) +
  labs(
    x = "Niveau de culture générale (note sur 10)",
    y = "Densité"
  ) +
  scale_fill_brewer(palette = "Set1") +
  theme_minimal()
p_interactive <- ggplotly(p)
p_interactive
```

**Commentaire**

*Les différences culturelles varient considérablement selon le niveau d'études. Les études du premier cycle montrent des similarités culturelles avec les autres niveaux, tandis que les études de L3 montrent une variance culturelle plus élevée.*

*La variation de la Culture Générale selon le Niveau d'Études suit une tendance décroissante. Ainsi, les étudiants en L3 ont une Culture Générale légèrement supérieure à celle des étudiants en L2  , qui ont à leur tour une Culture Générale légèrement supérieure à celle des étudiants en premier cycle.*


```{r}
library(dplyr)
library(ggplot2)
library(plotly)

# Calculate the percentages for each category
data_triche <- data %>%
  count(triche) %>%
  mutate(pourcentage = n / sum(n) * 100)

# Create the plot
ggplot(data_triche, aes(x = "", y = pourcentage, fill = triche)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar(theta = "y") +
  scale_fill_manual(values = c("oui" = "lightgreen", "presque..." = "#FED976", "non" = "#C70039")) +
  labs(
    title = "Pourcentage d'étudiants ayant répondu sans aide aux questions de culture générale",
    x = "",
    y = "",
    fill = "Réponse"
  ) +
  theme_void() +
  geom_text(aes(label = paste0(round(pourcentage, 1), "%")), 
            position = position_stack(vjust = 0.5)) 
```


# Conclusion

La culture générale des étudiants résulte d'une interconnexion complexe de divers facteurs tels que le genre, le temps consacré aux études, le stade académique et la filière suivie. Toutefois, il est essentiel de souligner que chaque étudiant est une entité unique, et des généralisations excessives risquent de négliger la richesse des expériences et des perspectives au sein de la communauté étudiante. L'accent sur l'individualité reste primordial, et une approche nuancée s'impose pour appréhender pleinement la diversité des cultures étudiantes.

En résumé, la culture générale des étudiants émerge d'une combinaison délicate de paramètres, incluant le contenu des programmes d'études, le niveau académique, le style de vie et les choix personnels. Pour favoriser un environnement éducatif équilibré et stimulant, il est suggéré d'adapter les programmes éducatifs, de promouvoir l'auto-apprentissage et de sensibiliser à l'importance de la diversité culturelle. Ces initiatives contribueront à former des étudiants mieux informés et prêts à relever les défis de leur vie professionnelle et personnelle.
